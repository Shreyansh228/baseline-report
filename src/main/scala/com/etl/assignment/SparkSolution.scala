package com.etl.assignment

import com.etl.assignment.config.JobContext
import com.etl.assignment.processor.SparkProcessor
import com.etl.assignment.reader.SparkCsvReader
import com.etl.assignment.report.SparkFinalReport

object SparkSolution {

  def main(args: Array[String]): Unit = {

    val path = "src/main/resources"
    val reader = new SparkCsvReader(new JobContext, path).read()

    val processor = new SparkProcessor().process(reader)

    val writer = new SparkFinalReport()
    writer.print(processor)

  }
}
/* ====> Sample output
year|world_barley_harvest|usa_barley_contribution_per|world_beef_slaughter|usa_beef_contribution_per|world_cotton_harvest|usa_usa_contribution_per
    2016|49293.0|0.021057756679447388|236869.0|0.0|29708.0|0.12952740002692878
    2017|48122.0|0.01643738830472549|242741.0|0.0|33408.0|0.1344588122605364
    2018|48759.0|0.016407227383662504|246795.0|0.0|33200.0|0.12831325301204818
    2019|49890.0|0.017839246341952296|248547.0|0.0|34241.0|0.14532285856137378
    2020|50069.0|0.017775469851604785|262541.0|0.0|34222.0|0.131289813570218
    2021|50171.0|0.01855653664467521|265166.0|0.0|34915.0|0.1287412286982672
    2022|50238.0|0.018531788685855328|267679.0|0.0|36117.0|0.12451200265802807
    2023|50393.0|0.019268549203262358|270155.0|0.0|36521.0|0.12431203964842145
    2024|50477.0|0.019236483943182045|272532.0|0.0|36708.0|0.12482292688242345
    2025|50604.0|0.019188206465892026|274554.0|0.0|36972.0|0.12509466623390675
    2026|50772.0|0.019124714409517057|276638.0|0.0|37138.0|0.12566643330281652
    2027|50877.0|0.01908524480610099|278708.0|0.0|37402.0|0.12592909470081814
    2028|50996.0|0.019040709075221585|280682.0|0.0|37696.0|0.12600806451612903
*/